<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="Description" content="Create and manage U.S. Small Business Administration events">
    <title>USSBA Events</title>
    <script src="assets/uswds-2.12.0/js/uswds-init.min.js"></script>
    <link href="assets/css/uswds.min.css" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href="public/favicon.ico">
    <script src="assets/js/uswds.min.js" defer></script>
    <script type="module" src="components/header.js" defer></script>
</head>

<body>
    <eventadmin-header></eventadmin-header>
    <main class="grid-container">
        <div class="grid-row grid-gap">
            <form class="usa-form usa-form--large tablet:grid-col">
                <fieldset class="usa-fieldset">
                    <legend class="usa-legend usa-legend--large">Create an Event</legend>
                    <p>
                        Required fields are marked with an asterisk (<abbr title="required" class="usa-hint usa-hint--required">*</abbr>).
                    </p>

                    <label class="usa-label" for="title">
                        Name of event
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="title" name="title" type="text" required />

                    <label class="usa-label" for="description">
                        Description
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="description" name="description" type="text" required />

                    <label class="usa-label" for="district-office">
                        District Office
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="district-office" name="district-office" type="text" required />

                    <label class="usa-label" for="attendance-type">
                        Attendance type
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <div class="usa-combo-box">
                        <select class="usa-select" id="attendance-type" name="attendance-type" required>
                            <option value>- Select -</option>
                            <option value="AL">In-person</option>
                            <option value="AK">Online</option>
                            <option value="AK">Both - In-person & Online</option>
                        </select>
                    </div>

                    <label class="usa-label" id="start-date-label" for="start-date">Start date</label>
                    <div class="usa-hint" id="start-date-hint">mm/dd/yyyy</div>
                    <div class="usa-date-picker">
                        <input class="usa-input" id="start-date" name="appointment-date" type="text" aria-describedby="start-date-label start-date-hint" />
                    </div>

                    <label class="usa-label" id="end-date-label" for="end-date">End date</label>
                    <div class="usa-hint" id="end-date-hint">mm/dd/yyyy</div>
                    <div class="usa-date-picker">
                        <input class="usa-input" id="end-date" name="end-date" type="text" aria-describedby="end-date-label end-date-hint" />
                    </div>

                    <div class="usa-form-group grid-row grid-gap">
                        <div class="desktop:grid-col-6">
                            <label class="usa-label" id="start-time-label" for="start-time">Start time</label>
                            <div class="usa-hint" id="start-time-hint">hh:mm</div>
                            <div class="usa-time-picker">
                                <input class="usa-input" id="start-time" name="start-time" type="text" aria-describedby="start-time-label start-time-hint" />
                            </div>
                        </div>

                        <div class="desktop:grid-col-6">
                            <label class="usa-label" id="end-time-label" for="end-time">End time</label>
                            <div class="usa-hint" id="end-time-hint">hh:mm</div>
                            <div class="usa-time-picker">
                                <input class="usa-input" id="end-time" name="end-time" type="text" aria-describedby="end-time-label end-time-hint" />
                            </div>
                        </div>
                    </div>

                    <legend class="usa-legend">Recurring</legend>
                    <div class="usa-checkbox">
                        <input class="usa-checkbox__input" id="check-historical-truth" type="checkbox" name="historical-figures" value="sojourner-truth" checked />
                        <label class="usa-checkbox__label" for="check-historical-truth">
                            Recurring
                        </label>
                    </div>
                </fieldset>
                <fieldset class="usa-fieldset">
                    <label class="usa-label" for="location">
                        Name of location
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="location" name="location" type="text" required />

                    <label class="usa-label" for="mailing-address-1">
                        Street address
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="mailing-address-1" name="mailing-address-1" type="text" required />

                    <div class="grid-row grid-gap">
                        <div class="desktop:grid-col-8">
                            <label class="usa-label" for="city">
                                City
                                <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                            </label>
                            <input class="usa-input" id="city" name="city" type="text" required />
                        </div>
                        <div class="desktop:grid-col-4">
                            <label class="usa-label" for="apt-floor-suite-no">Unit number</label>
                            <input class="usa-input" id="apt-floor-suite-no" name="apt-floor-suite-no" type="text" />
                        </div>
                    </div>

                    <label class="usa-label" for="state">State
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <div class="usa-combo-box">
                        <select class="usa-select" id="state" name="state" required>
                            <option value>- Select -</option>
                            <option value="AL">AL - Alabama</option>
                            <option value="AK">AK - Alaska</option>
                            <option value="AS">AS - American Samoa</option>
                            <option value="AZ">AZ - Arizona</option>
                            <option value="AR">AR - Arkansas</option>
                            <option value="CA">CA - California</option>
                            <option value="CO">CO - Colorado</option>
                            <option value="CT">CT - Connecticut</option>
                            <option value="DE">DE - Delaware</option>
                            <option value="DC">DC - District of Columbia</option>
                            <option value="FL">FL - Florida</option>
                            <option value="GA">GA - Georgia</option>
                            <option value="GU">GU - Guam</option>
                            <option value="HI">HI - Hawaii</option>
                            <option value="ID">ID - Idaho</option>
                            <option value="IL">IL - Illinois</option>
                            <option value="IN">IN - Indiana</option>
                            <option value="IA">IA - Iowa</option>
                            <option value="KS">KS - Kansas</option>
                            <option value="KY">KY - Kentucky</option>
                            <option value="LA">LA - Louisiana</option>
                            <option value="ME">ME - Maine</option>
                            <option value="MD">MD - Maryland</option>
                            <option value="MA">MA - Massachusetts</option>
                            <option value="MI">MI - Michigan</option>
                            <option value="MN">MN - Minnesota</option>
                            <option value="MS">MS - Mississippi</option>
                            <option value="MO">MO - Missouri</option>
                            <option value="MT">MT - Montana</option>
                            <option value="NE">NE - Nebraska</option>
                            <option value="NV">NV - Nevada</option>
                            <option value="NH">NH - New Hampshire</option>
                            <option value="NJ">NJ - New Jersey</option>
                            <option value="NM">NM - New Mexico</option>
                            <option value="NY">NY - New York</option>
                            <option value="NC">NC - North Carolina</option>
                            <option value="ND">ND - North Dakota</option>
                            <option value="MP">MP - Northern Mariana Islands</option>
                            <option value="OH">OH - Ohio</option>
                            <option value="OK">OK - Oklahoma</option>
                            <option value="OR">OR - Oregon</option>
                            <option value="PA">PA - Pennsylvania</option>
                            <option value="PR">PR - Puerto Rico</option>
                            <option value="RI">RI - Rhode Island</option>
                            <option value="SC">SC - South Carolina</option>
                            <option value="SD">SD - South Dakota</option>
                            <option value="TN">TN - Tennessee</option>
                            <option value="TX">TX - Texas</option>
                            <option value="UM">UM - United States Minor Outlying Islands</option>
                            <option value="UT">UT - Utah</option>
                            <option value="VT">VT - Vermont</option>
                            <option value="VI">VI - Virgin Islands</option>
                            <option value="VA">VA - Virginia</option>
                            <option value="WA">WA - Washington</option>
                            <option value="WV">WV - West Virginia</option>
                            <option value="WI">WI - Wisconsin</option>
                            <option value="WY">WY - Wyoming</option>
                            <option value="AA">AA - Armed Forces Americas</option>
                            <option value="AE">AE - Armed Forces Africa</option>
                            <option value="AE">AE - Armed Forces Canada</option>
                            <option value="AE">AE - Armed Forces Europe</option>
                            <option value="AE">AE - Armed Forces Middle East</option>
                            <option value="AP">AP - Armed Forces Pacific</option>
                        </select>
                    </div>

                    <label class="usa-label" for="zip">ZIP code
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr></label>
                    <input class="usa-input usa-input--medium" id="zip" name="zip" type="text" pattern="[\d]{5}(-[\d]{4})?" required />

                    <label class="usa-label" for="contact-name">
                        Full name
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input usa-input--xl" id="contact-name" name="contact-name" type="text" required aria-required="true" />

                    <label class="usa-label" for="email">
                        Email address
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="email" name="email" type="email" autocapitalize="off" autocorrect="off" required />

                    <label class="usa-label" for="phone-number">
                        Phone number
                        <abbr title="required" class="usa-hint usa-hint--required">*</abbr>
                    </label>
                    <input class="usa-input" id="phone" name="phone" type="tel" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" required />

                    <label class="usa-label" for="cost">Cost</label>
                    <div>
                        <div>$
                            <input type="usa-input number" aria-label="Enter amount in dollars" class="ds-c-field ds-c-field--currency" id="cost" name="cost">
                        </div>
                    </div>
                </fieldset>
                <div class="flash-container" hidden aria-hidden="true">
                    <div class="usa-alert usa-alert--success usa-alert--slim">
                        <div class="usa-alert__body">
                            <p class="usa-alert__text">
                                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.
                            </p>
                        </div>
                    </div>
                </div>
            </form>
        </div>

    </main>
    <script>
        /**
         * https://simonplend.com/how-to-use-fetch-to-post-form-data-as-json-to-your-api/
         * Helper function for POSTing data as JSON with fetch.
         *
         * @param {Object} options
         * @param {string} options.url - URL to POST data to
         * @param {FormData} options.formData - `FormData` instance
         * @return {Object} - Response body from URL that was POSTed to
         */
        async function postFormDataAsJson({
            url,
            formData
        }) {
            const plainFormData = Object.fromEntries(formData.entries());
            const formDataJsonString = JSON.stringify(plainFormData);

            const fetchOptions = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    Accept: "application/json",
                },
                body: formDataJsonString,
            };

            const response = await fetch(url, fetchOptions);

            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(errorMessage);
            }

            return response.json();
        }

        /**
         * Event handler for a form submit event.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit_event
         *
         * @param {SubmitEvent} event
         */
        async function handleFormSubmit(event) {
            event.preventDefault();

            const form = event.currentTarget;
            const url = form.action;

            try {
                const formData = new FormData(form);
                const responseData = await postFormDataAsJson({
                    url,
                    formData
                });

                console.log({
                    responseData
                });
                // Need to flash success (or failure here)

                event.target.reset();
            } catch (error) {
                console.error(error);
            }
        }

        const eventForm = document.getElementById("event-form");
        eventForm.addEventListener("submit", handleFormSubmit);
    </script>
    <script src="./assets/js/uswds.min.js"></script>
    <footer>
        <a href="https://www.sba.gov">U.S. Small Business Administration</a> | 409 3rd St, SW. Washington, DC 20416
    </footer>
</body>

</html>